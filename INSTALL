Installation instructions for Deployment Framework
------------------------------------------------------

Install instructions for the latest version of the Deployment Framework are also online:

 http://smwforum.ontoprise.com/smwforum/index.php/Help:Installing_Deployment_Framework_Extension
 
For the full manual of the Deployment Framework have a look at:

 http://smwforum.ontoprise.com/smwforum/index.php/Help:Deployment_Framework_1.3

Third party tools
==================
The deployment framework uses:

    - GNU unzip (GPL)
    - GNU patch (GPL)
    - 7zip (LGPL)
    
Requirements: 
=============
    MediaWiki 1.16 installed
    
Table of contents
=================
1. Installation
1a. Settings
2. I already have SMW installed. Can I use the DF though?
3. HowTo use the deployment framework
4. Restore wiki from restore point
5. Adding new repositories
6. Using Deployment Framework with a Proxy
7. Deployment Framework log

#
# 1. Installation:
# =================


(1) Unzip deployment-x.x.x.zip in the MediaWiki root folder.
(2) Replace in AdminSettings.php the example values given for  $wgDBadminuser (e.g. 'wikiadmin') and 
      $wgDBadminpassword (e.g 'adminpass') with the name and passwort of the 
      administrator user in your MYSQL installation. If you are using SMW+
      then your default name and passwort is: 'root', 'm8nix'.
(3) On Linux: make smwadmin.sh executable 
      Open the installation directory of the deployment framework in the 
      commandline interface: "<mediawiki-install-dir>/deployment/tools/"
      and call: "chmod +x smwadmin.sh"
(4) Include the path to the php binary to PATH variable (either Windows or Linux) 
(5) Include the path to mysql.exe to the PATH variable (either Windows or Linux)
(6) Test your installation
  Open the installation directory of the deployment framework in the 
  commandline interface in <mediawiki-install-dir>/deployment/tools/
  and call: smwadmin.bat/sh. You should see the help screen.
  
(7) add the following include statement in your LocalSettings.php 
    
     require_once('deployment/Deployment.php');
 
    It enables a special page for checking the integrity of the MW installation. 
    
(8) This is OPTIONAL! 
	There is a web-based version of DF called 'webadmin console'
    
    for installation instructions see deployment/tools/webadmin/INSTALL
    
#
# 1a.
#

There is a settings file located at deployment/settings.php. Take a look in it,
it is documented.
    
#    
# 2. I already have SMW installed. Can I use the DF though?
# ==========================================================

The DF requires extensions to have some metadata around. If you have SMW and/or SemanticForms
installed manually and you want to use the DF you may "lift" your installation
automatically. There is a tool called checkInstallation.php which can do that.

(the following instructions assume the "php" command lies in your PATH variable)

(1) Open a console in admin mode and change to deployment/tools/maintenance
(2) Run: php checkInstallation.php
        The tools does some checks and tell you if there are extensions to be lifted.
(2) If that is the case, run:
 
        php checkInstallation.php --lift

After that you can run smwadmin tool to see if it recognizes SMW as installed.

    deployment/tools/smwadmin -l

Note that the lifting process does only work for SMW + SF. If you have other extensions
that should be handled by the DF, you should remove them from the LocalSettings.php
and re-install them via DF. They get overwritten then!

The lifting should also work with the SemanticBundle. It is a bundle of several
semantic extensions containing SMW + SF among others. 

#
# 3. HowTo use the deployment framework
# ======================================

smwhalo admin utility v1.3, Ontoprise 2010

Usage: smwadmin [ -i | -d ] <package>[-<version>]
       smwadmin -u [ <package>[-<version>] ]
       smwadmin --install

        -i <package>: Install
        --install: Finalizes installation
        -d <package> ]: De-Install
        -u <package>: Update
        --dep : Check only dependencies but do not install.
        -l [ pattern ] : List installed packages.
        -r [name] : Restore installation. If name is missing, user is prompted.
        -rcreate [name]: Creates a restore point. If name is missing, a unique ID is created.
        -rlist: Lists existing restore points.

Examples:

        smwadmin -i smwhalo: Installs latest version of smwhalo.
        smwadmin --finalize: Finalizes every installation. Must be called after something was installed or updated.
        smwadmin -u smw: Updates the given package to the specified version. (if possible)
        smwadmin -u: Updates complete installation
        smwadmin -u --dep: Shows what would be updated.
        smwadmin -d smw: Removes the package smw.
        smwadmin -l: List all installed/available packages 

#
# 4. Restore wiki from restore point
# ===================================
Whenever the Deployment Framework performs one the following actions,
it offers to create a "Wiki Restore Point":
* Installing a package: smwadmin -i <package>
* De-installing a package: smwadmin -d <package>
* Updating a package: smwadmin -u <package>

You may create a restore point and do an arbitrarily number of subsequent operations. You
can create as many restore points as you want.

You can create a restore point without changing the wiki by using this command:

smwadmin -rcreate [name] 

If name is missing a unique ID will be created. This can be useful if you want to 
save your wiki periodically.

Call "smwadmin -r [name]" to bring your Wiki back to a Wiki Restore Point. If name
is missing, you will be prompted which should be restored.

Simply said, the Deployment Framework can undo your previous action and bring
your Wiki back to previous state (including the data, articles and
configuration).


#
# 5. Adding new repositories
# ===========================
        
File for repository links:
/deployment/tools/repositories

You may add new repositories here, the Ontoprise repo is already configured.

#
# 6. Using Deployment Framework with a Proxy
# ===========================================


Open <mediawiki-install-dir>/deployment/settings.php and set the proxy server address for
'df_proxy'. For Example: 'df_proxy' => 'proxy.example.com:8080'

#
# 7. Deployment Framework log
# ============================
The DF writes a log about the operations. It is stored in your system's temporary folder:

On Windows:
    C:\temp\df_log
On Linux:
    /tmp/df_log
    
The are usually two log files for each run of smwadmin. One for the installation process and
one for the initialization process.

#
# 8. Importing ontologies
# ========================
First, take a look into tools/onto2mwxml/README.TXT and install onto2mwxml.

Importing an ontology is as follows:

    smwadmin -i <ontology file (full path)>
 
